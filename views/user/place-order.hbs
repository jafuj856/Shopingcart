


<style>

@import url(https://fonts.googleapis.com/css?family=Lato:400,300,700);
body,html {
  height:100%;
  margin:0;
 color: black;
}

h2 {
  margin-bottom:0px;
  margin-top:25px;
  text-align:center;
  font-weight:200;
  font-size:19px;
  font-size:1.2rem;
  
}
.container {
  height:100%;
  -webkit-box-pack:center;
  -webkit-justify-content:center;
      -ms-flex-pack:center;
          justify-content:center;
  -webkit-box-align:center;
  -webkit-align-items:center;
      -ms-flex-align:center;
          align-items:center;
  display:-webkit-box;
  display:-webkit-flex;
  display:-ms-flexbox;
  display:flex;
  background:-webkit-linear-gradient(#c5e5e5, #ccddf9);
  background:linear-gradient(#c9e5e9,#ccddf9);
}
.dropdown-select.visible {
  display:block;
}
.dropdown {
  position:relative;
}
ul {
  margin:0;
  padding:0;
}
ul li {
  list-style:none;
  padding-left:10px;
  cursor:pointer;
}
ul li:hover {
  background:rgba(255,255,255,0.1);
}
.dropdown-select {
  position:absolute;
  background:#77aaee;
  text-align:left;
  box-shadow:0px 3px 5px 0px rgba(0,0,0,0.1);
  border-bottom-right-radius:5px;
  border-bottom-left-radius:5px;
  width:90%;
  left:2px;
  line-height:2em;
  margin-top:2px;
  box-sizing:border-box;
}
.thin {
  font-weight:400;
}
.small {
  font-size:12px;
  font-size:.8rem;
}
.half-input-table {
  border-collapse:collapse;
  width:100%;
}
.half-input-table td:first-of-type {
  border-right:10px solid #4488dd;
  width:50%;
}
.window {
  height:440px;
  width:800px;
  background:#ffffff;
  display:-webkit-box;
  display:-webkit-flex;
  display:-ms-flexbox;
  display:flex;
  box-shadow: 0px 15px 50px 10px rgba(0, 0, 0, 0.2);
  border-radius:30px;
  z-index:10;
}
.order-info {
 
  height:100%;
  width:50%;
  padding-left:2%;
  padding-right:2%;

 
  position:relative;
}
.price {
  bottom:0px;
  position:absolute;
  right:0px;
  color:#4488dd;
}
.order-table td:first-of-type {
  width:25%;
}
.order-table {
    position:relative;
}
.line {
  height:1px;
  width:100%;
  margin-top:10px;
  margin-bottom:10px;
  background:#ddd;
}
.order-table td:last-of-type {
  vertical-align:top;
  padding-left:25px;
}


.full-width {
  width:100%;
}
.pay-btn {
  border:none;
  background:#22b877;
  line-height:2em;
  border-radius:10px;
  font-size:19px;
  font-size:1.2rem;
  color:#fff;
  cursor:pointer;
  position:absolute;
  bottom:25px;
  width:calc(100% - 50px);
  -webkit-transition:all .2s ease;
          transition:all .2s ease;
}
.pay-btn:hover {
  background:#22a877;
    color:#eee;
  -webkit-transition:all .2s ease;
          transition:all .2s ease;
}

.total {
  margin-top:25px;
  font-size:20px;
  font-size:1.3rem;
  position:absolute;
  bottom:30px;
  right:27px;
  left:35px;
}
.dense {
  line-height:1.2em;
  font-size:16px;
  font-size:1rem;
}
.input-field {
  background:rgba(255,255,255,0.1);
  margin-bottom:10px;
  margin-top:3px;
  line-height:1.5em;
  font-size:20px;
  font-size:1.3rem;
  border:none;
  padding:5px 10px 5px 10px;
  color:#fff;
  box-sizing:border-box;
  width:100%;
  margin-left:auto;
  margin-right:auto;
}
.credit-info {
 
  height:100%;
  width:50%;
  color:#eee;
  -webkit-box-pack:center;
  -webkit-justify-content:center;
      -ms-flex-pack:center;
          justify-content:center;
  font-size:14px;
  font-size:.9rem;

  padding-left:25px;
  padding-right:25px;
  border-top-right-radius:30px;
  border-bottom-right-radius:30px;
  position:relative;
}
.dropdown-btn {
  background:rgba(255,255,255,0.1);
  width:100%;
  border-radius:5px;
  text-align:center;
  line-height:1.5em;
  cursor:pointer;
  position:relative;
  -webkit-transition:background .2s ease;
          transition:background .2s ease;
}
.dropdown-btn:after {
  content: '\25BE';
  right:8px;
  position:absolute;
}
.dropdown-btn:hover {
  background:rgba(255,255,255,0.2);
  -webkit-transition:background .2s ease;
          transition:background .2s ease;
}
.dropdown-select {
  display:none;
}
.credit-card-image {
  display:block;
  max-height:80px;
  margin-left:auto;
  margin-right:auto;
  margin-top:35px;
  margin-bottom:15px;
}
.credit-info-content {
    padding-top: 15%;
 

  -webkit-flex-flow:column;
      -ms-flex-flow:column;
          flex-flow:column;
  display:-webkit-box;
  display:-webkit-flex;
  display:-ms-flexbox;
  display:flex;
  width:100%;
}
@media (max-width: 600px) {
  .window {
    width: 100%;
    height: 100%;
    display:block;
    border-radius:0px;
  }
  .order-info {
    width:100%;
    height:auto;
    padding-bottom:100px;
    border-radius:0px;
  }
  .credit-info {
  
    width:100%;
    height:auto;
    padding-bottom:100px;
    border-radius:0px;
  }
  .pay-btn {
    border-radius:0px;
  }
}


</style>

<section>



  
 


     <form action=""style="padding: 0%; padding-bottom: 10%; text-align: center;
      border-radius: 15px; " id="check-out-form">
    
 
   
    
<div class='container' style="padding: 5%;">

  
  <div class='window'>
   
    <div class='order-info'>
     
         <h3 class="text-center mb-3 mt-3">Add Shipping Adress</h3>
   
      <div class="form-group" style="text-align: left;">
        <label for="adress " class="text-left">Address</label>
          <input type="text" class="form-control" name="adress" id="adress" required="true" />
        </div>
         <div class="form-group" style="text-align: left;">
        <label for="adress " class="text-left">Pincode</label>
          <input type="text" class="form-control" name="pincode" id="pincod" required="true" />
        </div>

         <div class="form-group" style="text-align: left;">
        <label for="number " class="text-left">Phone number</label>
          <input type="number" class="form-control" name="mbno" id="district" required="true" />
          <input type="text" name="userid" id="" value="{{user._id}}" hidden>
        </div>
       

     




</div>
        <div class='credit-info'>
          
          
          <div class='credit-info-content'>
<h6 class="text-center text-danger mt-2" id="warning"></h6>

           <div class="card ml-4 mt-4" style="width: 18rem;height: auto; border: black 1px solid;" id="card">


  <div class="card-body" style="text-align: left;">
   
   
  
    <h4 class="card-titel mb-2 text-muted">Total Amount : {{this.total}}</h4>
  
    <div class="line"></div>
     <h6 class="card-subtitle mb-1 mt-2 text-muted">Payment Method</h6>
       
    <input type="radio" id="cod" name="paymentmethod" value="COD"> <label class="text-dark" for="cod"> COD</label><br>
    <input type="radio" id="online" name="paymentmethod" value="ONLINE">  <label class="text-dark" for="online"> Online Payment</label>
   
  </div>
  <input type="submit"  class="btn btn-primary mb-2" style="width: 100px;margin-left: 60%;" value="Pay" />
 
</div>
            

          </div>

        </div>
      </div>
       </form>
</div>

</section>

<script>
  $("#check-out-form").submit((e)=>{
  
    e.preventDefault()
    $.ajax({
      url:'/place-order',
      method:'post',
      data:$('#check-out-form').serialize(),
      success:(Response)=>{
        if(Response.status1==='done1'){
         
         location.href='/order-success'

        }
       
        else if(Response.status1==='done'){
        
        razorpaypayment(Response)
        }
        else{
          
          $('#warning').html('Choose any PaymentMethode !')
          $('#card').css('margin-top:',0)
        }
      }
    })
  });
function razorpaypayment(order){
  var options = {
    "key": "rzp_test_fNPLUMucBHQqta", // Enter the Key ID generated from the Dashboard
    "amount": order.amount, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
    "currency": "INR",
    "name": "Acme Corp",
    "description": "Test Transaction",
    "image": "https://example.com/your_logo",
    "order_id": order.id, //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
    "handler": function (response){
      
        verfyPayment(response,order)
      
    },
    "prefill": {
        "name": "Gaurav Kumar",
        "email": "gaurav.kumar@example.com",
        "contact": "9000090000"
    },
    "notes": {
        "address": "Razorpay Corporate Office"
    },
    "theme": {
        "color": "#3399cc"
    }
};
    
    var rzp1 = new Razorpay(options);
     rzp1.open();
    
}
  function verfyPayment(payment,order){
    $.ajax({
      url:'/verfy-payment',
      data:{
        payment,
        order
      },
      method:'post',
      success:(response)=>{
        if(response.status){
          location.href='/order-success'
        }
        else{
          alert("payment failed")
        }
      }
    })

  }     
  
</script>



